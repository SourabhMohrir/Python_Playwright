pipeline {
  agent any

  parameters {
    choice(name: 'SUITE', choices: "API\nregression", description: 'Select test suite')
  }

  environment {
    PLAYWRIGHT_USER = credentials('playwright-user')
  }

stages {
    stage('Run Tests') {
      steps {
        withEnv([
          "USER_EMAIL_1=${PLAYWRIGHT_USER_USR}",
          "USER_PASSWORD_1=${PLAYWRIGHT_USER_PSW}"
        ]) {
          sh 'ci/run_tests.sh'
        }
      }
    }
  }

  post {
    always {
      archiveArtifacts artifacts: 'playwright-report/**/*', allowEmptyArchive: true
    }
  }
}